// ============================================
// ðŸ’€ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø«ØºØ±Ø§Øª Solidity
// Ù…Ø­Ø¯Ø«Ø© Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø± - ØªØºØ·ÙŠ Ø£ÙƒØ«Ø± Ù…Ù† 100 Ù†ÙˆØ¹ Ø«ØºØ±Ø©
// ============================================

const VulnerabilityDB = {
    // Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø«ØºØ±Ø§Øª
    patterns: {
        reentrancy: [
            {
                name: 'Reentrancy (Single Function)',
                pattern: /\.call\{value:[^}]*\}\([^)]*\)|\.send\(|\.transfer\(/g,
                severity: 'critical',
                cwe: 'CWE-841',
                description: 'Ù‡Ø¬ÙˆÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ - Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø®Ø§Ø±Ø¬ÙŠ Ù‚Ø¨Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©',
                fix: 'Ø§Ø³ØªØ®Ø¯Ù… Ù†Ù…Ø· Checks-Effects-Interactions Ø£Ùˆ ReentrancyGuard Ù…Ù† OpenZeppelin',
                example: `
// âŒ Ø®Ø·Ø£:
function withdraw(uint amount) public {
    require(balances[msg.sender] >= amount);
    payable(msg.sender).call{value: amount}("");
    balances[msg.sender] -= amount;
}

// âœ… ØµØ­ÙŠØ­:
function withdraw(uint amount) public {
    require(balances[msg.sender] >= amount);
    balances[msg.sender] -= amount;
    payable(msg.sender).call{value: amount}("");
}`
